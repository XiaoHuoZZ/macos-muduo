# 限制并发连接

# 文件描述符耗尽带来的问题

epoll_wait返回，有一个新的连接请求到来，

如果我们调用accept，有可能返回EMFILE错误，这意味着本进程的文件描述符已经达到上限

**此时我们没有拿到描述符来表示这个连接，所以我们就无法closes它。**下一次epoll_wait因为还会存在新连接等待处理，会立即返回， **程序会陷入busy loop**

# muduo库的做法

**时刻持有一个空闲的文件描述符**，遇见accept返回错误，先关闭这个空闲文件，获得一个名额。然后再accept拿到这个新的socket, 随后立即close调

最后重新打开一个空闲文件，把空闲文件重新持有

# 程序层面的做法

我们在编程的时候可以认为的设置一个并发上限 int 类型

一旦大于这个值就踢掉连接